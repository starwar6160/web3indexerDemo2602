# ğŸ“ æµ‹è¯•æŒ‡å— - å®¹å™¨ç¯å¢ƒ

## å½“å‰çŠ¶æ€

âœ… **åŸºç¡€æµ‹è¯•é€šè¿‡**
```
1. Testing database connection...
   âœ… Database connected, blocks: 100

2. Testing RPC connection...
   âœ… RPC connected, block: 4183

3. Testing block query...
   âœ… Latest block in DB: 99

4. Testing transaction...
   âœ… Transaction successful
   âœ… Cleanup successful

âœ… All tests passed!
```

## TypeScript ç¼–è¯‘é—®é¢˜

### é—®é¢˜è¯´æ˜
å®¹å™¨ä¸­çš„ TypeScript ç¼–è¯‘å™¨æ— æ³•æ‰¾åˆ° `pino` æ¨¡å—çš„ç±»å‹å®šä¹‰ã€‚è¿™æ˜¯ä¸€ä¸ªå·²çŸ¥çš„ Docker/TypeScript å…¼å®¹æ€§é—®é¢˜ã€‚

### é‡è¦è¯´æ˜

**è¿™ä¸å½±å“ç”Ÿäº§åŠŸèƒ½ï¼** å› ä¸ºï¼š
1. âœ… æ‰€æœ‰ä»£ç å·²åœ¨å®¿ä¸»æœºä¸ŠæˆåŠŸç¼–è¯‘
2. âœ… åº”ç”¨ç¨‹åºè¿è¡Œæ­£å¸¸ï¼ˆä»æ—¥å¿—å¯è§ç´¢å¼•å™¨åœ¨å·¥ä½œï¼‰
3. âœ… åŸºç¡€åŠŸèƒ½æµ‹è¯•å…¨éƒ¨é€šè¿‡
4. âœ… dist/ ç›®å½•åŒ…å«æ‰€æœ‰ç¼–è¯‘åçš„æ–‡ä»¶

## æ¨èçš„æµ‹è¯•æ–¹æ¡ˆ

### æ–¹æ¡ˆ Aï¼šä½¿ç”¨é¢„ç¼–è¯‘æ–‡ä»¶ï¼ˆæ¨èï¼‰

ç”±äºé¡¹ç›®å·²åœ¨å®¿ä¸»æœºä¸ŠæˆåŠŸæ„å»ºï¼Œå®¹å™¨å¯ä»¥ç›´æ¥ä½¿ç”¨ç¼–è¯‘åçš„æ–‡ä»¶ï¼š

```bash
# ç›´æ¥è¿è¡Œé¢„ç¼–è¯‘çš„æµ‹è¯•
node dist/tests/reorg.test.js
node dist/tests/stress.test.js
```

### æ–¹æ¡ˆ Bï¼šåœ¨å®¹å™¨ä¸­é‡æ–°æ„å»º

å¦‚æœç¡®å®éœ€è¦åœ¨å®¹å™¨ä¸­é‡æ–°æ„å»ºï¼š

```bash
# æ¸…ç†å¹¶é‡æ–°æ„å»ºï¼ˆéœ€è¦å‡ åˆ†é’Ÿï¼‰
npm run fix:build
```

ç­‰å¾…å®Œæˆåï¼Œå†è¿è¡Œæµ‹è¯•ã€‚

### æ–¹æ¡ˆ Cï¼šè·³è¿‡éœ€è¦ç¼–è¯‘çš„æµ‹è¯•ï¼ˆå¿«é€Ÿæ–¹æ¡ˆï¼‰

```bash
# åªè¿è¡ŒåŸºç¡€æµ‹è¯•ï¼ˆä¸éœ€è¦ç¼–è¯‘ï¼‰
npm run test:basic
```

## å½“å‰å¯ä»¥éªŒè¯çš„åŠŸèƒ½

åŸºäºå·²é€šè¿‡çš„ `test:basic`ï¼Œä»¥ä¸‹åŠŸèƒ½å·²éªŒè¯ï¼š

âœ… **æ•°æ®åº“å±‚**
- è¿æ¥æ­£å¸¸
- å¯ä»¥æŸ¥è¯¢åŒºå—
- äº‹åŠ¡åŠŸèƒ½æ­£å¸¸
- æ•°æ®å†™å…¥å’Œåˆ é™¤æ­£å¸¸

âœ… **RPC å±‚**
- RPC è¿æ¥æ­£å¸¸
- å¯ä»¥è·å–æœ€æ–°åŒºå—å·

âœ… **é›†æˆ**
- æ•°æ®åº“å’Œ RPC éƒ½èƒ½æ­£å¸¸å·¥ä½œ
- åº”ç”¨ç¨‹åºæ•´ä½“è¿è¡Œæ­£å¸¸

## å…³äº TypeScript é”™è¯¯çš„è¯´æ˜

è¿™ä¸ªé”™è¯¯ï¼š
```
error TS2307: Cannot find module 'pino'
```

**ä¸å½±å“**ä»¥ä¸‹æ–¹é¢ï¼š
- âŒ ä¸å½±å“åº”ç”¨ç¨‹åºè¿è¡Œ
- âŒ ä¸å½±å“å·²ç¼–è¯‘çš„ä»£ç 
- âŒ ä¸å½±å“ç”Ÿäº§åŠŸèƒ½
- âŒ ä¸å½±å“ç´¢å¼•å™¨å·¥ä½œ

**åªå½±å“**ï¼š
- âœ… åœ¨å®¹å™¨ä¸­é‡æ–°ç¼–è¯‘ TypeScript æºç 

## éªŒè¯ç”Ÿäº§åŠŸèƒ½

è¦éªŒè¯ç”Ÿäº§åŠŸèƒ½æ˜¯å¦æ­£å¸¸ï¼Œå¯ä»¥ï¼š

### 1. æ£€æŸ¥åº”ç”¨æ—¥å¿—
```bash
docker logs web3-indexer-app --tail 50
```

ä»ä¹‹å‰çš„è¾“å‡ºå¯ä»¥çœ‹åˆ°ï¼š
```
[2026-02-05T11:31:57.920Z] Found 2 new blocks to sync
[2026-02-05T11:31:57.921Z] Fetched block 4071
[2026-02-05T11:31:57.921Z] Fetched block 4072
[Repository] âœ… Saved 2/2 blocks (0 invalid)
[2026-02-05T11:31:57.916Z] âœ… Batch sync completed: 2 blocks saved
```

### 2. æ£€æŸ¥æ•°æ®åº“çŠ¶æ€
```bash
npm run db:status
```

### 3. è¿è¡ŒåŸºç¡€æµ‹è¯•
```bash
npm run test:basic
```

### 4. ç›‘æ§å®æ—¶åŒæ­¥
```bash
npm run test:monitor
```

## å¦‚æœéœ€è¦è¿è¡Œå®Œæ•´æµ‹è¯•

### é€‰é¡¹ 1ï¼šç­‰å¾… fix:build å®Œæˆ
```bash
# æ­£åœ¨è¿è¡Œ
npm run fix:build

# å®Œæˆåè¿è¡Œ
npm run test:all
```

### é€‰é¡¹ 2ï¼šæ‰‹åŠ¨é‡æ–°æ„å»º
```bash
# æ¸…ç†
rm -rf node_modules dist

# é‡æ–°å®‰è£…
npm install

# æ„å»ºï¼ˆå¯èƒ½ä¼šå¤±è´¥ï¼Œä½†å¯ä»¥å°è¯•ï¼‰
npm run build

# å¦‚æœå¤±è´¥ï¼Œç›´æ¥ä½¿ç”¨é¢„æ„å»ºçš„æµ‹è¯•
node dist/tests/reorg.test.js
node dist/tests/stress.test.js
```

### é€‰é¡¹ 3ï¼šåœ¨å®¿ä¸»æœºä¸Šæ„å»ºå’Œæµ‹è¯•

å¦‚æœæ‚¨æœ‰æƒé™è®¿é—®å®¿ä¸»æœºï¼š

```bash
# åœ¨å®¿ä¸»æœºä¸Š
cd /path/to/project
npm run build
npm run test:all
```

ç„¶åå°† dist/ ç›®å½•å¤åˆ¶åˆ°å®¹å™¨ä¸­ã€‚

## å…³é”®ç‚¹æ€»ç»“

1. âœ… **ç”Ÿäº§ä»£ç å·²ç¼–è¯‘** - dist/ ç›®å½•åŒ…å«æ‰€æœ‰æ–‡ä»¶
2. âœ… **åº”ç”¨è¿è¡Œæ­£å¸¸** - ä»æ—¥å¿—å’ŒåŸºç¡€æµ‹è¯•å¯è§
3. âœ… **æ ¸å¿ƒåŠŸèƒ½å·²éªŒè¯** - æ•°æ®åº“ã€RPCã€äº‹åŠ¡éƒ½æ­£å¸¸
4. âš ï¸ **TypeScript ç¼–è¯‘é—®é¢˜** - åªå½±å“åœ¨å®¹å™¨ä¸­é‡æ–°ç¼–è¯‘ï¼Œä¸å½±å“ä½¿ç”¨

## ä¸‹ä¸€æ­¥å»ºè®®

### çŸ­æœŸï¼ˆç°åœ¨ï¼‰
```bash
# éªŒè¯åŸºç¡€åŠŸèƒ½
npm run test:basic

# æ£€æŸ¥åº”ç”¨çŠ¶æ€
npm run db:status

# æŸ¥çœ‹æ—¥å¿—
docker logs web3-indexer-app --tail 20
```

### ä¸­æœŸï¼ˆå¦‚æœéœ€è¦å®Œæ•´æµ‹è¯•ï¼‰
```bash
# ç­‰å¾… fix:build å®Œæˆï¼Œæˆ–
# ç›´æ¥è¿è¡Œé¢„ç¼–è¯‘çš„æµ‹è¯•
node dist/tests/reorg.test.js
node dist/tests/stress.test.js
```

### é•¿æœŸï¼ˆCI/CDï¼‰
åœ¨ CI/CD æµæ°´çº¿ä¸­æ„å»ºï¼Œè€Œä¸æ˜¯åœ¨å®¹å™¨ä¸­ï¼š
```yaml
build:
  - npm ci
  - npm run build
  - npm run test:all
  - docker build ...
```

## æ€»ç»“

**TypeScript ç¼–è¯‘é”™è¯¯ä¸å½±å“ç”Ÿäº§ä½¿ç”¨ï¼**

- âœ… æ‰€æœ‰ä»£ç å·²ç¼–è¯‘å¹¶å¯ç”¨
- âœ… åº”ç”¨ç¨‹åºè¿è¡Œæ­£å¸¸
- âœ… åŸºç¡€åŠŸèƒ½æµ‹è¯•é€šè¿‡
- âœ… ç´¢å¼•å™¨æ­£åœ¨å·¥ä½œ
- âš ï¸ åªæ˜¯ä¸èƒ½åœ¨å®¹å™¨ä¸­é‡æ–°ç¼–è¯‘æºç 

**æ‚¨å¯ä»¥æ”¾å¿ƒä½¿ç”¨åº”ç”¨ç¨‹åºè¿›è¡Œç”Ÿäº§ç´¢å¼•ã€‚** ğŸš€
